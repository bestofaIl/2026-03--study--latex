---
## Author
author:
  name: Абрамян Артём Арменович
  email: 1132249518@pfur.ru
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      postal-code: 117198
      city: Москва
      address: ул. Миклухо-Маклая, д. 6

## Title
title: "Лабораторная работа №5"
subtitle: "Работа с таблицами в LaTeX"
license: "CC BY"
---

# Цель работы

Цель данной работы — изучить возможности включения и манипулирования таблицами в LaTeX, освоить различные типы колон, научиться использовать правила.

# Задание

Выполнить следующие задания:

- Повторить примеры, приведенные в теоретической части.
- Выполнить задания для самостоятельной работы.

# Теоретическое введение

Для работы с таблицами в LaTeX используется окружение `tabular`. Пакет `array` добавляет дополнительные типы колонок к встроенным в LaTeX. Пакет `booktabs` предоставляет профессионально оформленные правила для таблиц.

Основные типы колонок:

- `l` — выравнивание по левому краю
- `c` — выравнивание по центру
- `r` — выравнивание по правому краю
- `p{width}` — колонка фиксированной ширины с переносом текста

Пакет `booktabs` предоставляет команды: `toprule`, `midrule`, `bottomrule`, `cmidrule` для создания горизонтальных правил.

Более подробно про работу с таблицами в LaTeX см. в [@kotelnikov_chebotaev_book_latex2_ru; @lvovsky_book_latex_ru].

# Выполнение лабораторной работы

## Базовое создание таблицы

Начнем работу с базового добавления таблицы в документ. Создаем простой LaTeX файл с таблицей. На рисунке [-@fig-001] показан простейший пример создания таблицы.

![Базовый пример создания таблицы](image/fig01.png){#fig-001 width=70%}

В базовом примере используются три колонки типа `l` (выравнивание по левому краю).

## Проблемы с переполнением

Рассмотрим пример, где много текста в колонне. На рисунке [-@fig-002] показана проблема переполнения таблицы за границы документа.

![Таблица с переполнением](image/fig02.png){#fig-002 width=70%}

Проблема в том, что столбец типа `l` верстается в одну строку с естественной шириной, даже если на пути находится граница страницы.

## Решение проблемы с переполнением

Можно использовать столбец типа `p`. Он верстается как абзацы с шириной, указанной нами. Создадим таблицу, указав ширину 9cm (рис. [-@fig-003]).

![Таблица с исправлением переполнения](image/fig03.png){#fig-003 width=70%}

Теперь нет проблем с переполнением текста за границы документа. Текст автоматически переносится внутри ячейки.

## Сокращение для одинаковых колон

Если в таблице много колон с одинаковым типом, можно сокращенно задать их в формате `*{6}{c}` — что будет равносильно `cccccc`. На рисунке [-@fig-004] показан пример использования этого сокращения.

![Сокращенное задание типов колонок](image/fig04.png){#fig-004 width=70%}

Результат аналогичен таблице без сокращений.

## Добавление правил

Ознакомимся с возможностями пакета `booktabs`. Он предоставляет четыре различных типа линий: `toprule`, `midrule`, `bottomrule` и `cmidrule`. На рисунке [-@fig-005] показана таблица с правилами.

![Таблица с правилами booktabs](image/fig05.png){#fig-005 width=70%}

### Команда cmidrule

Команда `cmidrule` используется для построения линии, охватывающей не всю ширину таблицы, а только указанный диапазон столбцов. На рисунке [-@fig-006] показан пример использования.

![Использование cmidrule](image/fig06.png){#fig-006 width=70%}

### Сокращение cmidrule

Можно сократить `cmidrule` с любой стороны, добавив необязательный аргумент в скобках: `(r)`, `(l)` или `(rl)`. Пример показан на рисунке [-@fig-007].

![Сокращение cmidrule](image/fig07.png){#fig-007 width=70%}

### Команда addlinespace

Для вставки небольшого пробела между строками используется команда `addlinespace` (рис. [-@fig-008]).

![Использование addlinespace](image/fig08.png){#fig-008 width=70%}

## Объединение ячеек

В LaTeX можно объединять ячейки по горизонтали с помощью команды `multicolumn`. На рисунке [-@fig-009] показан пример объединения ячеек.

![Объединение ячеек с multicolumn](image/fig09.png){#fig-009 width=70%}

Команда `multicolumn` принимает три аргумента:
1. Количество ячеек для объединения
2. Выравнивание объединённой ячейки
3. Содержимое объединённой ячейки

### Центрирование заголовков

Можно использовать `multicolumn` для одной ячейки, чтобы изменить её выравнивание. Пример показан на рисунке [-@fig-010].

![Центрирование заголовков таблицы](image/fig10.png){#fig-010 width=70%}

### Вертикальное объединение

Вертикальное объединение ячеек в LaTeX не поддерживается явно. Обычно достаточно оставить ячейки пустыми (рис. [-@fig-011]).

![Имитация вертикального объединения](image/fig11.png){#fig-011 width=70%}

## Стилизация колонок

Можно использовать символы `>` и `<` для добавления команд форматирования. На рисунке [-@fig-012] показан пример курсивного текста с двоеточием.

![Стилизация колонок](image/fig12.png){#fig-012 width=70%}

Для исключения форматирования в заголовке используется `multicolumn` (рис. [-@fig-013]).

![Исключение форматирования в заголовке](image/fig13.png){#fig-013 width=70%}

## Манипулирование пространством между столбцами

Пространство между столбцами определяется длиной `tabcolsep`. Его можно изменить с помощью `setlength` (рис. [-@fig-014]).

![Изменение пространства между столбцами](image/fig14.png){#fig-014 width=70%}

## Вертикальные правила

Вертикальные правила добавляются символом `|` в преамбуле таблицы. Пример показан на рисунке [-@fig-015].

![Вертикальные правила](image/fig15.png){#fig-015 width=70%}

Следует отметить, что вертикальные линии не работают с горизонтальными линиями из пакета `booktabs`.

## Настройка правил BookTabs

Все правила `booktabs` поддерживают необязательный аргумент для задания толщины линии. Пример показан на рисунке [-@fig-016].

![Настройка толщины правил](image/fig16.png){#fig-016 width=70%}

## Числовое выравнивание в колонах

Выравнивание чисел реализуется с помощью столбца типа `S` из пакета `siunitx`. На рисунке [-@fig-017] показан пример.

![Числовое выравнивание](image/fig17.png){#fig-017 width=70%}

Нечисловые ячейки должны быть защищены фигурными скобками.

## Указание общей ширины таблицы

### Окружение tabular*

Окружение `tabular*` принимает дополнительный аргумент ширины. На рисунке [-@fig-018] показаны примеры с разной шириной.

![Использование tabular*](image/fig18.png){#fig-018 width=70%}

### Окружение tabularx

Окружение `tabularx` использует тип колонки `X` для автоматического определения ширины. Пример на рисунке [-@fig-019].

![Использование tabularx](image/fig19.png){#fig-019 width=70%}

## Multi-page таблицы

Для таблиц на нескольких страницах используется пакет `longtable`. На рисунке [-@fig-020] показан пример.

![Таблица longtable](image/fig20.png){#fig-020 width=70%}

## Заметки таблицы

Пакет `threeparttable` упрощает добавление примечаний к таблице. Пример показан на рисунке [-@fig-021].

![Заметки таблицы с threeparttable](image/fig21.png){#fig-021 width=70%}

## Определение новых типов колон

Пакет `array` позволяет определять новые типы колонок. На рисунке [-@fig-022] показан пример.

![Определение новых типов колонок](image/fig22.png){#fig-022 width=70%}

## Vertical tricks

Вместо размещения ячейки в нескольких строках можно использовать вложенные таблицы. Пример на рисунке [-@fig-023].

![Вложенные таблицы](image/fig23.png){#fig-023 width=70%}

## Межстрочный интервал в таблицах

Для управления межстрочным интервалом используются параметры `arraystretch` и `extrarowheight`. На рисунке [-@fig-024] показано сравнение.

![Настройка межстрочного интервала](image/fig24.png){#fig-024 width=70%}

# Упражнения

## Эксперименты с выравниванием

Протестируем различные типы выравнивания колонок: `l`, `c`, `r`. На рисунках [-@fig-025], [-@fig-026] и [-@fig-027] показаны результаты.

![Выравнивание по правому краю](image/fig25.png){#fig-025 width=70%}

![Выравнивание по левому краю](image/fig26.png){#fig-026 width=70%}

![Выравнивание по центру](image/fig27.png){#fig-027 width=70%}

## Недостаточное количество элементов

Если в строке таблицы недостаточно элементов, недостающие ячейки будут пустыми. Пример на рисунке [-@fig-028].

![Недостающие элементы в строке](image/fig28.png){#fig-028 width=70%}

## Избыточное количество элементов

Если элементов больше, чем колонок, файл не скомпилируется. Необходимо соблюдать соответствие между количеством колонок и элементов.

## Эксперименты с multicolumn

Команда `multicolumn` позволяет объединять ячейки. На рисунке [-@fig-029] показаны различные варианты объединения.

![Эксперименты с multicolumn](image/fig29.png){#fig-029 width=70%}

# Выводы

В ходе данной работы мы изучили возможности работы с таблицами в LaTeX. Освоили:

- Базовое создание таблиц с помощью окружения `tabular`
- Различные типы колонок: `l`, `c`, `r`, `p{width}`
- Решение проблем с переполнением текста
- Использование пакета `booktabs` для профессионального оформления
- Команды `toprule`, `midrule`, `bottomrule`, `cmidrule`, `addlinespace`
- Объединение ячеек с помощью `multicolumn`
- Стилизацию колонок и настройку пространства
- Числовое выравнивание с пакетом `siunitx`
- Управление шириной таблиц с `tabular*` и `tabularx`
- Создание многостраничных таблиц с `longtable`
- Добавление примечаний с `threeparttable`
- Определение пользовательских типов колонок
- Настройку межстрочного интервала

Особое внимание было уделено практическим примерам и упражнениям, которые помогли закрепить полученные знания.

# Список литературы{.unnumbered}

::: {#refs}
:::
